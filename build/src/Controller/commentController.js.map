{"version":3,"file":"commentController.js","names":["_express","_interopRequireDefault","require","_bodyParser","_newsModel","_dotenv","_Comment","obj","__esModule","default","router","Router","dotenv","config","use","bodyParser","urlencoded","extended","json","addcomment","req","res","next","id","params","newsi","News","findById","status","message","comment","text","body","savedComment","Comment","create","comments","push","savednews","save","err","exports","deletecomment","newsId","commentId","news","filter","_id","toString","countComments","send","commentCount","length"],"sources":["../../../src/Controller/commentController.js"],"sourcesContent":["import  Router  from 'express';\nconst router = Router();\nimport bodyParser from 'body-parser';\nimport News from \"../model/newsModel.js\";\nimport dotenv from 'dotenv';\nimport Comment from '../model/Comment.js';\ndotenv.config();\nrouter.use(bodyParser.urlencoded({ extended: true }))\nrouter.use(bodyParser.json());\n\n\n\n// ==============================add comments on a news==================================\n\n \n \n  export const addcomment = async (req, res, next) => {\n    const id = req.params.id;\n  \n    try {\n      const newsi = await News.findById(id);\n      if (!newsi) {\n        return res.status(404).json({ message: 'news not found' });\n      }\n  \n      const comment = {\n        text: req.body.text,\n      };\n      const savedComment = await Comment.create(comment);\n      newsi.comments.push(savedComment);\n      const savednews = await newsi.save();\n  \n      return res.status(201).json(savednews);\n    } catch (err) {\n      return res.status(500).json({ message: err.message });\n    }\n  };\n\n// ======================delete a comment =================\n\nexport const deletecomment = async (req, res, next) => {\n    const newsId = req.params.newsId;\n    const commentId = req.params.commentId;\n  \n    try {\n      const news = await News.findById(newsId);\n  \n      if (!news) {\n        return res.status(404).json({ message: 'News not found' });\n      }\n  \n      news.comments = news.comments.filter((comment) => comment._id.toString() !== commentId);\n  \n      await news.save();\n  \n      return res.json(news);\n    } catch (err) {\n      return res.status(500).json({ message: err.message });\n    }\n  };\n  \n\n\n\n// ===========================count comments===========================\nexport const countComments = async (req, res) => {\n    const news = await News.findById(req.params.id);\n    if (!news) {\n      return res.status(404).send({ status: \"fail\", message: \"news not found\" });\n    }\n  \n    const commentCount = news.comments.length;\n  \n    res.status(200).send({\n      status: \"success\",\n      message: `news has ${commentCount} comments.`,\n    });\n  };"],"mappings":"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"}