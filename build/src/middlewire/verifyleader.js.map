{"version":3,"file":"verifyleader.js","names":["_jsonwebtoken","_interopRequireDefault","require","_userModel","obj","__esModule","default","Authorization","req","res","next","token","headers","authorization","decoded","jwt","verify","process","env","JWT_SECRET","user","User","findById","id","role","status","json","message","error","_default","exports"],"sources":["../../../src/middlewire/verifyleader.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\nimport User from \"../model/userModel.js\";\n\nasync function Authorization(req, res, next) {\n  try {\n    // console.log(req.headers);\n    const token = req.headers.authorization;\n    if (token) {\n      const decoded = jwt.verify(token, process.env.JWT_SECRET);\n      const user = await User.findById(decoded.id);\n      if (user.role === \"leader\" || user.role === \"admin\") {\n        next();\n      } else {\n        return res.status(401).json({\n          message: \"Only leader can book\"\n        });\n      }\n    } else {\n      return res.status(401).json({\n        status: \"failed\",\n        message: \"Unauthorized\"\n      });\n    }\n  } catch (error) {\n    return res.status(400).json({\n      message: \"Invalid token\"\n    });\n  }\n}\n\nexport default Authorization;\n"],"mappings":";;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAyC,SAAAD,uBAAAG,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAEzC,eAAeG,aAAaA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;EAC3C,IAAI;IACF;IACA,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAO,CAACC,aAAa;IACvC,IAAIF,KAAK,EAAE;MACT,MAAMG,OAAO,GAAGC,qBAAG,CAACC,MAAM,CAACL,KAAK,EAAEM,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;MACzD,MAAMC,IAAI,GAAG,MAAMC,kBAAI,CAACC,QAAQ,CAACR,OAAO,CAACS,EAAE,CAAC;MAC5C,IAAIH,IAAI,CAACI,IAAI,KAAK,QAAQ,IAAIJ,IAAI,CAACI,IAAI,KAAK,OAAO,EAAE;QACnDd,IAAI,EAAE;MACR,CAAC,MAAM;QACL,OAAOD,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;IACF,CAAC,MAAM;MACL,OAAOlB,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BD,MAAM,EAAE,QAAQ;QAChBE,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;EACF,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,OAAOnB,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BC,OAAO,EAAE;IACX,CAAC,CAAC;EACJ;AACF;AAAC,IAAAE,QAAA,GAEctB,aAAa;AAAAuB,OAAA,CAAAxB,OAAA,GAAAuB,QAAA"}