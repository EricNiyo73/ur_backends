{"version":3,"file":"verifyAdmin.js","names":["_jsonwebtoken","_interopRequireDefault","require","_userModel","obj","__esModule","default","Authorization","req","res","next","token","headers","authorization","decoded","jwt","verify","process","env","JWT_SECRET","user","User","findById","id","role","status","json","message","error","_default","exports"],"sources":["../../../src/middlewire/verifyAdmin.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport User from \"../model/userModel.js\";\r\n\r\nasync function Authorization(req, res, next) {\r\n  try {\r\n    // console.log(req.headers);\r\n    const token = req.headers.authorization;\r\n    if (token) {\r\n      const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n      const user = await User.findById(decoded.id);\r\n      if (user.role === \"leader\") {\r\n        next();\r\n      } else {\r\n        return res.status(401).json({\r\n          message: \"Only leader can book\"\r\n        });\r\n      }\r\n    } else {\r\n      return res.status(401).json({\r\n        status: \"failed\",\r\n        message: \"Unauthorized\"\r\n      });\r\n    }\r\n  } catch (error) {\r\n    return res.status(400).json({\r\n      message: \"Invalid token\"\r\n    });\r\n  }\r\n}\r\n\r\nexport default Authorization;\r\n"],"mappings":";;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAyC,SAAAD,uBAAAG,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAEzC,eAAeG,aAAaA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;EAC3C,IAAI;IACF;IACA,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAO,CAACC,aAAa;IACvC,IAAIF,KAAK,EAAE;MACT,MAAMG,OAAO,GAAGC,qBAAG,CAACC,MAAM,CAACL,KAAK,EAAEM,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;MACzD,MAAMC,IAAI,GAAG,MAAMC,kBAAI,CAACC,QAAQ,CAACR,OAAO,CAACS,EAAE,CAAC;MAC5C,IAAIH,IAAI,CAACI,IAAI,KAAK,QAAQ,EAAE;QAC1Bd,IAAI,EAAE;MACR,CAAC,MAAM;QACL,OAAOD,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE;QACX,CAAC,CAAC;MACJ;IACF,CAAC,MAAM;MACL,OAAOlB,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BD,MAAM,EAAE,QAAQ;QAChBE,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;EACF,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,OAAOnB,GAAG,CAACgB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BC,OAAO,EAAE;IACX,CAAC,CAAC;EACJ;AACF;AAAC,IAAAE,QAAA,GAEctB,aAAa;AAAAuB,OAAA,CAAAxB,OAAA,GAAAuB,QAAA"}